\documentclass{documentation}

\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\isom}{Isom}
\DeclareMathOperator{\Adj}{Adj}
\DeclareMathOperator{\GL}{{\rm GL}}
\DeclareMathOperator{\PGL}{{\rm PGL}}
\newcommand{\pseudo}{\Psi\hspace*{-1mm}\isom}

\title{Tame Genus Package}

\author{Peter A. Brooksbank}
\address{Bucknell University}
\email{pbrooksb@bucknell.edu}

\author{Joshua Maglione}
\address{Colorado State University}
\email{josh.maglione@gmail.com}

\author{James B. Wilson}
\address{Colorado State University}
\email{James.Wilson@ColoState.Edu}

\date{\today}
\version{0.1}
\copyrightyear{2015}

% ------------------------------------------------------------------------------

\begin{document}

\frontmatter

\maketitle
\tableofcontents

\mainmatter

\chapter{Introduction}

The goal of this package is to provide {\sc Magma} \cite{Magma} with high performance functionality for groups with tame genus. 
When appropriate, all intrinsics dealing with groups also work for tensors ({\tt TenSpcElt}). 
This package includes intrinsics for automorphism and isomorphism computations, canonical labeling, and constructing random groups of genus 1 or 2 of exponent  $\leq p^2$. 
Mathematical details of these algorithms can be found in \cite{BMW}.

\section{Verbose Printing and Version}

We have included intrinsics to allow for verbose printing. 
Currently, there is only one level of printing, so either it is on of off. 

\index{SetVerbose}
\begin{intrinsics}
SetVerbose(MonStgElt, RngIntElt) : -> 
\end{intrinsics}

{\tt SetVerbose} is a built in Magma function, but with this package, this intrinsic accepts the string {\tt "TameGenus"} and an integer in $\{0,1\}$. 

We have included an intrinsic to check which version of TameGenus you have attached in Magma.

\index{TameGenusVersion}
\begin{intrinsics}
TameGenusVersion() : -> MonStgElt
\end{intrinsics}

Returns the version number for the TameGenus package attached in Magma.


\chapter{Constructors}

We introduce intrinsics to construct nonabelian groups of genus $\leq 2$. 
We provide some algorithms to construct random groups, and we make no attempt at asserting any analysis of these algorithms.
In particular, these random constructors may not select groups in a uniform distribution. 

\index{TGRandomGroup}
\begin{intrinsics}
TGRandomGroup(q, n, g : parameters) : RngIntElt, RngIntElt, RngIntElt -> GrpPC
    Exponentp : BoolElt : true
\end{intrinsics}

Given $q=p^m$, $n>0$, and $g>0$, returns a $p$-group $G$ with genus $\leq g$ and order $q^{n+g}=p^{m(n+g)}$. 
If $q$ is not a prime, then the centroid of the group will be a proper field extension of $\mathbb{F}_p$, isomorphic to $\mathbb{F}_q$. 
If $\circ: V\times V\rightarrowtail W$ is the commutation tensor of $G$, then $\dim_{\mathcal{C}(\circ)}(V)=n$ and $\dim_{\mathcal{C}(\circ)}(W)=g$, where $\mathcal{C}(\circ)$ is the centroid of $\circ$. 
The algorithm is based on the Universal Coefficients Theorem, see \cite{LGM:book}*{Chapter~9} the statement and proof.
There is one optional parameter: {\tt Exponentp}. 

\begin{description}
\item[\textcolor{blue}{\tt Exponentp}]
The default is set to {\tt true}.
Set to false if you want the returned group to have exponent $\leq p^2$.  
\end{description}

\index{RandomGenus2Group}
\begin{intrinsics}
RandomGenus2Group(q, d : parameters) : RngIntElt, [RngIntElt] -> GrpPC
    Exponentp : BoolElt : true
\end{intrinsics}

Given $q=p^m$ and $d=[d_1, \dots, d_k]$, where $d_i>0$, it returns a genus 2 group $G$ whose commutation tensor $\circ : V\times V\rightarrowtail W$ has centroid $\mathcal{C}(\circ)\cong \mathbb{F}_q$ and whose $\perp$-decomposition has blocks of dimensions $d_1,\dots,d_k$ (over $\mathcal{C}(\circ)$).
If $d_i=1$, then this increases the dimension of the radical by 1 (over $\mathcal{C}(\circ)$).
There is one optional parameter: {\tt Exponentp}. 

\begin{description}
\item[\textcolor{blue}{\tt Exponentp}]
The default is set to {\tt true}.
Set to false if you want the returned group to have exponent $\leq p^2$.  
\end{description}

\index{RandomGenus1Group}
\begin{intrinsics}
RandomGenus1Group(q, d, r : parameters) : RngIntElt, RngIntElt, RngIntElt -> GrpPC
    Exponentp : BoolElt : true
\end{intrinsics}

Given $q=p^m$, $d>0$, and $r\geq 0$, it returns a group $G$ with genus 1 and of order $q^{2d+r+1}$.
The center of $G$ has order $q^{r+1}$, and $G$ is $dm$-generated.
There is one optional parameter: {\tt Exponentp}. 

\begin{description}
\item[\textcolor{blue}{\tt Exponentp}]
The default is set to {\tt true}.
Set to false if you want the returned group to have exponent $\leq p^2$.  
\end{description}

\index{Genus2Group}
\begin{intrinsics}
Genus2Group(f) : RngUPolElt -> GrpPC
Genus2Group(f) : RngMPolElt -> GrpPC
\end{intrinsics}

Given either a univariate or homogeneous multivariate polynomial in $x$ (and $y$), it returns a group $G$ whose tensor from communtation has a Pfaffian equivalent to $f$.

\section{Examples}

\chapter{Automorphism groups}

We have two intrinsics for constructing automorphism groups: one with group inputs and the other with tensor inputs. 

\index{TGAutomorphismGroup}
\begin{intrinsics}
TGAutomorphismGroup(G : parameters) : GrpPC -> GrpAuto
    Cent : BoolElt : true
    Method : RngIntElt : 0 
    Order : BoolElt : false
\end{intrinsics}

Given a $p$-group $G$, of class 2, exponent $p$, and genus $\leq 2$, this returns $\Aut(G)$.
This currently does not work with $p=2$.
This intrinsic provides three optional parameters: {\tt Cent}, {\tt Method}, and {\tt Order}.

\begin{description}
\item[\textcolor{blue}{\tt Cent}]
This parameter is a flag for the algorithm to rewrite the tensor over its centroid. 
In order to rewrite over the centroid, we assume the centroid is a local ring, see \cite{eMAGma} for details.
The default is set to {\tt true}, so by default, the algorithm computes the centroid and rewrites the tensor over the residue field.
If you know the centroid is trivial, set {\tt Cent} to {\tt false} to save time.
WARNING: if the centroid is a proper field extension of $\mathbb{F}_p$, then the full automorphism group may not be constructed (this is a bug we will fix in the near future).
\item[\textcolor{blue}{\tt Method}]
The default is $0$, and it accepts any input from $\{ 0,1,2\}$. 
This will set the method for handling the sloped part of the tensor.
If you want to use the adjoint-tensor method, set {\tt Method} to $1$, and if you want to use the Pfaffian method, set {\tt Method} to $2$. The default will try to find the optimal method based on the input; this is not optimally tuned.
\item[\textcolor{blue}{\tt Order}]
Finally, {\tt Order} is included so you have the order of the returned automorphism group. 
The data structure of {\tt GrpAuto} makes it hard to compute the order of the group. 
However, when computing $\Aut(G)$, we construct a (linear) representation of the group. 
We can take advantage of the LMG functions \cite{LMG} in Magma to compute the order of the representation. 
The default is set to {\tt false}. 
WARNING: if set to {\tt true} this step could take the majority of the computation time.
\end{description}

\index{TGPseudoIsometryGroup}
\begin{intrinsics}
TGPseudoIsometryGroup(T : parameters) : TenSpcElt -> GrpMat
    Cent : BoolElt : true
    Method : RngIntElt : 0
\end{intrinsics}

Given an alternating tensor $T : V \times V \rightarrowtail W$, where $V$ and $W$ are $\mathbb{F}_q$-vector spaces, returns the pseudo-isometry group $\pseudo(T)\leq \GL(V)\times \GL(W)$.
This currently does not work for even $q$. 
This intrinsic provides two optional parameters: {\tt Cent} and {\tt Method}. 

\begin{description}
\item[\textcolor{blue}{\tt Cent}]
This parameter is a flag for the algorithm to rewrite the tensor over its centroid. 
In order to rewrite over the centroid, we assume the centroid is a local ring, see \cite{eMAGma} for details.
The default is set to {\tt true}, so by default, the algorithm computes the centroid and rewrites the tensor over the residue field.
If you know the centroid is trivial, set {\tt Cent} to {\tt false} to save time.
WARNING: if the centroid is a proper field extension of $\mathbb{F}_q$, then the full pseudo-isometry group may not be constructed (this is a bug we will fix in the near future).
\item[\textcolor{blue}{\tt Method}]
The default is $0$, and it accepts any input from $\{ 0,1,2\}$. 
This will set the method for handling the sloped part of the tensor.
If you want to use the adjoint-tensor method, set {\tt Method} to $1$, and if you want to use the Pfaffian method, set {\tt Method} to $2$. The default will try to find the optimal method based on the input; this is not optimally tuned.
\end{description}

\section{Examples}
We list some examples to illustrate the functionality of the automorphism intrinsics.

\chapter{Isomorphisms}

\index{TGIsIsomorphic}
\begin{intrinsics}
TGIsIsomorphic(G, H : parameters) : GrpPC, GrpPC -> BoolElt
    Cent : BoolElt : true
    Constructive : BoolElt : true
    Method : RngIntElt : 0
\end{intrinsics}

Given class 2, exponent $p$, $p$-groups $G$ and $H$ of genus $\leq 2$, decides if $G\cong H$.
If $G\cong H$, then an isomorphism is provided unless specified otherwise.
Currently this does not work for $p=2$.  
There are three optional parameters: {\tt Cent}, {\tt Constructive}, and {\tt Method}.

\begin{description}
\item[\textcolor{blue}{\tt Cent}]
This parameter is a flag for the algorithm to rewrite the tensors over their centroids. 
In order to rewrite over the centroid, we assume the centroid is a local ring, see \cite{eMAGma} for details.
The default is set to {\tt true}, so by default, the algorithm computes the centroid and rewrites the tensor over the residue field.
If you know the centroid is trivial, set {\tt Cent} to {\tt false} to save time.
WARNING: if the centroid is a proper field extension of $\mathbb{F}_p$, then the full coset of (potential) isomorphisms are not fully exhausted. 
That is, it is possible the algorithm concludes {\tt false} when $G\cong H$ (this is a bug we will fix in the near future).
\item[\textcolor{blue}{\tt Constructive}]
The default is {\tt true}. 
Set to {\tt false} if you do not want the algorithm to explicitly construct an isomorphism.
\item[\textcolor{blue}{\tt Method}]
The default is $0$, and it accepts any input from $\{ 0,1,2\}$. 
This will set the method for handling the sloped part of the tensor.
If you want to use the adjoint-tensor method, set {\tt Method} to $1$, and if you want to use the Pfaffian method, set {\tt Method} to $2$. The default will try to find the optimal method based on the input; this is not optimally tuned.
\end{description}

\index{TGIsPseudoIsometric}
\begin{intrinsics}
TGIsPseudoIsometric(T, S : parameters) : TenSpcElt, TenSpcElt -> BoolElt
    Cent : BoolElt : true
    Constructive : BoolElt : true
    Method : RngIntElt : 0
\end{intrinsics}

\color{black}
Given alternating tensors $T, S : V\times V \rightarrowtail W$, where $V$ and $W$ are $\mathbb{F}_q$-vector spaces, it decides if $T$ is pseudo-isometric to $S$.
If $T$ is pseudo-isometric to $S$, then a pseudo-isometry is provided (as an element of $\GL(V)\times \GL(W)$) unless specified otherwise. 
Currently this does not work for even $q$. 
There are three optional parameters: {\tt Cent}, {\tt Constructive}, and {\tt Method}.

\begin{description}
\item[\textcolor{blue}{\tt Cent}]
This parameter is a flag for the algorithm to rewrite the tensors over their centroids. 
In order to rewrite over the centroid, we assume the centroid is a local ring, see \cite{eMAGma} for details.
The default is set to {\tt true}, so by default, the algorithm computes the centroid and rewrites the tensor over the residue field.
If you know the centroid is trivial, set {\tt Cent} to {\tt false} to save time.
WARNING: if the centroid is a proper field extension of $\mathbb{F}_q$, then the full coset of (potential) pseudo-isometries are not fully exhausted. 
That is, it is possible the algorithm concludes {\tt false} when $T$ is pseudo-isometric to $S$ (this is a bug we will fix in the near future).
\item[\textcolor{blue}{\tt Constructive}]
The default is {\tt true}. 
Set to {\tt false} if you do not want the algorithm to explicitly construct an isomorphism.
\item[\textcolor{blue}{\tt Method}]
The default is $0$, and it accepts any input from $\{ 0,1,2\}$. 
This will set the method for handling the sloped part of the tensor.
If you want to use the adjoint-tensor method, set {\tt Method} to $1$, and if you want to use the Pfaffian method, set {\tt Method} to $2$. The default will try to find the optimal method based on the input; this is not optimally tuned.
\end{description}


\section{Examples}
We list some examples to illustrate the functionality of the isomorphism intrinsics.


\chapter{Canonical Labeling}

\index{Genus!groups}\index{Genus!tensors}
\begin{intrinsics}
Genus(G) : GrpPC -> RngIntElt
Genus(T) : TenSpcElt -> RngIntElt
\end{intrinsics}

Given a $p$-group $G$, returns the genus of $G$. 
That is, the dimension of $[G,G]$ over its centroid.
For a tensor $T$, it returns the dimension of its image over its centroid. 

\index{Genus2Signature!groups}\index{Genus2Signature!tensors}
\begin{intrinsics}
Genus2Signature(G) : GrpPC -> List
Genus2Signature(T) : TenSpcElt -> List
\end{intrinsics}

Given a genus 2 group or tensor, returns the canonical genus 2 signature. 
The list has two parts.
The first entry is a sequence of odd integers corresponding to the dimensions of the flat indecomposable spaces.
The second entry is a list of sequences in $\mathbb{F}_q$, the field the given data is defined over.
The sequences in  the second entry are the coefficients of the homogeneous polynomial in $x$ and $y$ in degree $d$:
\[ c_1x^d + c_2 x^{d-1}y + c_3 x^{d-2}y^2 + \cdots + c_{d+1}y^d. \]
Because this is a canonical label, two groups (or tensors) are isoclinic (or pseudo-isometric) if, and only if, their genus 2 signatures are equal. 

Currently, this does not work for even $q$. 
WARNING: if the centroid is a proper field extension of $\mathbb{F}_q$, the field the data is defined over, then this is not a canonical label. 
That is, two groups can be isomorphic but have two different genus 2 signatures. 
This is a bug we will fix in the near future.

\section{Examples}
We list some examples to illustrate the functionality of these intrinsics.

\begin{bibdiv}
\begin{biblist}

\bib{Magma}{article}{
   author={Bosma, Wieb},
   author={Cannon, John},
   author={Playoust, Catherine},
   title={The Magma algebra system. I. The user language},
   note={Computational algebra and number theory (London, 1993)},
   journal={J. Symbolic Comput.},
   volume={24},
   date={1997},
   number={3-4},
   pages={235--265},
   issn={0747-7171},
   review={\MR{1484478}},
}

\bib{BMW}{article}{
   author={Brooksbank, Peter A.},
   author={Maglione, Joshua},
   author={Wilson, James B.},
   title={A fast isomorphism test for groups whose Lie algebra has genus 2},
   journal={J. Algebra},
   volume={473},
   date={2017},
   pages={545--590},
   issn={0021-8693},
   review={\MR{3591162}},
}

\bib{LMG}{unpublished}{
   author={Holt, Derek F.}
   author={O'Brien, E. A.}
   author={MORE???}
   title={The Large Matrix Group Package},
   status={\url{http://magma.maths.usyd.edu.au/magma/handbook/text/680}},
}

\bib{LGM:book}{book}{
   author={Leedham-Green, C. R.},
   author={McKay, S.},
   title={The structure of groups of prime power order},
   series={London Mathematical Society Monographs. New Series},
   volume={27},
   note={Oxford Science Publications},
   publisher={Oxford University Press, Oxford},
   date={2002},
   pages={xii+334},
   isbn={0-19-853548-1},
   review={\MR{1918951}},
}

\bib{eMAGma}{misc}{
   author={Maglione, Joshua}
   author={Wilson, James B.}
   title={Experimental Multilinear Algebra Group},
   status={version 1.2.2, GitHub, 2017},
   note={\url{https://github.com/algeboy/eMAGma}},
}

\end{biblist}
\end{bibdiv}

\printindex

\end{document}
